
# funnel_explorer

model: segment_m3
group: 'segment'

joins:
- from_view: segment_funnel_explorer
  as: a

- join_view: segment_3_session_tracks
  as: b
  sql_on: ${a.session_id} = ${b.session_id}

- join_view: segment_6_user_session_facts
  as: c
  sql_on: ${b.mprove_visitor_id} = ${c.mprove_visitor_id}
  
- join_view: segment_5_session_track_facts
  as: d
  sql_on: ${a.session_id} = ${d.session_id}
  
# - join_view: segment_users
#   as: e
#   # sql_on: coalesce(users.mapped_user_id, users.user_id) = sessions.user_id
#   sql_on: coalesce(${e.mapped_user_id}, ${e.user_id}) = ${b.mprove_visitor_id} 
  

  
