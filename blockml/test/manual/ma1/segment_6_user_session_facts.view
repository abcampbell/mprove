
# 6_user_session_facts.view
# user_session_facts

view: segment_6_user_session_facts
derived_table: |
  SELECT
    ${s.mprove_visitor_id},
    MIN(${s.session_start_at}) AS first_date,
    MAX(${s.session_start_at}) AS last_date,
    COUNT(*) AS number_of_sessions
  FROM
    ${segment_3_session_tracks AS s}
  LEFT JOIN
    ${segment_4_track_facts AS sf}
  ON
    ${s.session_id} = ${sf.session_id}
  GROUP BY
    1
# permanent: true

fields:

- dimension: mprove_visitor_id
  hidden: true
  sql: mprove_visitor_id   

- dimension: number_of_sessions
  sql: number_of_sessions  
  
# - dimension: number_of_sessions_tiered

- time: first_date_frames
  timeframes:
  - date
  - week
  - month
  sql: first_date
  
- time: last_date_frames
  timeframes:
  - date
  - week
  - month
  sql: last_date  
  
  
  
  
  
  
  
  