<div fxLayout="row" fxLayoutGap="20px" fxLayoutAlign="start center">
  <div fxFlex="40px" class="ml-10">
    <div *ngIf="!isFirst && fraction.operator === fractionOperatorEnum.Or"
      >OR</div
    >
    <div *ngIf="!isFirst && fraction.operator === fractionOperatorEnum.And"
      >AND</div
    >
  </div>

  <mat-form-field>
    <mat-select
      class="mp-fraction-type-select-width-230"
      data-cy="fractionTsType"
      [(ngModel)]="fraction.type"
      (selectionChange)="typeChange($event)"
    >
      <mat-option
        [value]="fractionTypeEnum.TsIsAnyValue"
        data-cy="fractionTsTypeIsAnyValue"
        >is any value</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsOnYear"
        data-cy="fractionTsTypeIsOnYear"
        >is on Year</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsOnMonth"
        data-cy="fractionTsTypeIsOnMonth"
        >is on Month</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsOnDay"
        data-cy="fractionTsTypeIsOnDay"
        >is on Day</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsOnHour"
        data-cy="fractionTsTypeIsOnHour"
        >is on Hour</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsOnMinute"
        data-cy="fractionTsTypeIsOnMinute"
        >is on Minute</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsInRange"
        data-cy="fractionTsTypeIsInRange"
        >is in range</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsBeforeDate"
        data-cy="fractionTsTypeIsBeforeDate"
        >is before</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsAfterDate"
        data-cy="fractionTsTypeIsAfterDate"
        >is after</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsBeforeRelative"
        data-cy="fractionTsTypeIsBeforeRelative"
        >is before (relative)</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsAfterRelative"
        data-cy="fractionTsTypeIsAfterRelative"
        >is after (relative)</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsInLast"
        data-cy="fractionTsTypeIsInLast"
        >is in last</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsNull"
        data-cy="fractionTsTypeIsNull"
        >is null</mat-option
      >

      <mat-option
        [value]="fractionTypeEnum.TsIsNotNull"
        data-cy="fractionTsTypeIsNotNull"
        >is not null</mat-option
      >
    </mat-select>
  </mat-form-field>

  <!-- on -->
  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsOnYear"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="yearConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="yearClosed()"
  >
  </dp-date-picker>

  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsOnMonth"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="monthConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="monthClosed()"
  >
  </dp-date-picker>

  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsOnDay"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="dayConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="dayClosed()"
  >
  </dp-date-picker>

  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsOnHour"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="hourConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="hourClosed()"
  >
  </dp-date-picker>

  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsOnMinute"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="minuteConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="minuteClosed()"
  >
  </dp-date-picker>

  <!-- range -->
  <div
    *ngIf="fraction.type === fractionTypeEnum.TsIsInRange"
    fxLayout="row"
    fxLayoutGap="20px"
    fxLayoutAlign="start center"
  >
    <dp-date-picker
      [mode]="'daytime'"
      data-cy="fractionTsDate"
      [theme]="'dp-material'"
      [config]="minuteConfig"
      [(ngModel)]="date"
      [displayDate]="date"
      (close)="rangeFromClosed()"
    >
    </dp-date-picker>

    <div>to</div>

    <dp-date-picker
      [mode]="'daytime'"
      data-cy="fractionTsDateTo"
      [theme]="'dp-material'"
      [config]="minuteConfig"
      [(ngModel)]="dateTo"
      [displayDate]="dateTo"
      (close)="rangeToClosed()"
    >
    </dp-date-picker>
  </div>

  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsBeforeDate"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="minuteConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="beforeDateClosed()"
  >
  </dp-date-picker>

  <dp-date-picker
    *ngIf="fraction.type === fractionTypeEnum.TsIsAfterDate"
    data-cy="fractionTsDate"
    [mode]="'daytime'"
    [theme]="'dp-material'"
    [config]="minuteConfig"
    [(ngModel)]="date"
    [displayDate]="date"
    (close)="afterDateClosed()"
  >
  </dp-date-picker>

  <!-- relative -->
  <div
    *ngIf="
      fraction.type === fractionTypeEnum.TsIsBeforeRelative ||
      fraction.type === fractionTypeEnum.TsIsAfterRelative
    "
    fxLayout="row"
    fxLayoutGap="20px"
    fxLayoutAlign="start center"
  >
    <form [formGroup]="relativeValueForm">
      <mat-form-field class="mp-fraction-relative-value-width-50">
        <input
          matInput
          type="number"
          data-cy="fractionTsRelativeValue"
          formControlName="relativeValue"
          (blur)="
            relativeValueBlur(relativeValueForm.controls['relativeValue'])
          "
        />
        <mat-error>
          <m-validation-msg
            [errors]="relativeValueForm.controls['relativeValue'].errors"
          ></m-validation-msg>
        </mat-error>
      </mat-form-field>
    </form>

    <mat-form-field>
      <mat-select
        [(ngModel)]="fraction.ts_relative_unit"
        data-cy="fractionTsRelativeUnit"
        (selectionChange)="relativeUnitChange($event)"
      >
        <mat-option
          [value]="fractionTsRelativeUnitEnum.Years"
          data-cy="fractionTsRelativeUnitYears"
          >Years</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeUnitEnum.Quarters"
          data-cy="fractionTsRelativeUnitQuarters"
          >Quarters</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeUnitEnum.Months"
          data-cy="fractionTsRelativeUnitMonths"
          >Months</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeUnitEnum.Weeks"
          data-cy="fractionTsRelativeUnitWeeks"
          >Weeks</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeUnitEnum.Days"
          data-cy="fractionTsRelativeUnitDays"
          >Days</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeUnitEnum.Hours"
          data-cy="fractionTsRelativeUnitHours"
          >Hours</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeUnitEnum.Minutes"
          data-cy="fractionTsRelativeUnitMinutes"
          >Minutes</mat-option
        >
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-select
        [(ngModel)]="fraction.ts_relative_complete_option"
        data-cy="fractionTsRelativeCompleteOption"
        (selectionChange)="relativeCompleteChange($event)"
      >
        <mat-option
          [value]="fractionTsRelativeCompleteOptionEnum.Complete"
          data-cy="fractionTsRelativeCompleteOptionComplete"
          >complete</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeCompleteOptionEnum.Incomplete"
          data-cy="fractionTsRelativeCompleteOptionIncomplete"
          >incomplete</mat-option
        >
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-select
        [(ngModel)]="fraction.ts_relative_when_option"
        data-cy="fractionTsRelativeWhenOption"
        (selectionChange)="relativeWhenChange($event)"
      >
        <mat-option
          [value]="fractionTsRelativeWhenOptionEnum.Ago"
          data-cy="fractionTsRelativeWhenOptionAgo"
          >ago</mat-option
        >

        <mat-option
          [value]="fractionTsRelativeWhenOptionEnum.InFuture"
          data-cy="fractionTsRelativeWhenOptionInFuture"
          >in future</mat-option
        >
      </mat-select>
    </mat-form-field>
  </div>

  <!-- for -->
  <div
    *ngIf="
      fraction.type === fractionTypeEnum.TsIsBeforeDate ||
      fraction.type === fractionTypeEnum.TsIsAfterDate ||
      fraction.type === fractionTypeEnum.TsIsBeforeRelative ||
      fraction.type === fractionTypeEnum.TsIsAfterRelative
    "
    fxLayout="row"
    fxLayoutGap="20px"
    fxLayoutAlign="start center"
  >
    <mat-form-field>
      <mat-select
        [(ngModel)]="fraction.ts_for_option"
        data-cy="fractionTsForOption"
        (selectionChange)="forOptionChange($event)"
      >
        <mat-option
          [value]="fractionTsForOptionEnum.For"
          data-cy="fractionTsForOptionFor"
          >for</mat-option
        >

        <mat-option
          [value]="fractionTsForOptionEnum.ForInfinity"
          data-cy="fractionTsForOptionForInfinity"
          >for infinity</mat-option
        >
      </mat-select>
    </mat-form-field>

    <form
      *ngIf="fraction.ts_for_option === fractionTsForOptionEnum.For"
      [formGroup]="forValueForm"
    >
      <mat-form-field class="mp-fraction-for-value-width-50">
        <input
          matInput
          type="number"
          data-cy="fractionTsForValue"
          formControlName="forValue"
          (blur)="forValueBlur(forValueForm.controls['forValue'])"
        />
        <mat-error>
          <m-validation-msg
            [errors]="forValueForm.controls['forValue'].errors"
          ></m-validation-msg>
        </mat-error>
      </mat-form-field>
    </form>

    <mat-form-field
      *ngIf="fraction.ts_for_option === fractionTsForOptionEnum.For"
    >
      <mat-select
        [(ngModel)]="fraction.ts_for_unit"
        data-cy="fractionTsForUnit"
        (selectionChange)="forUnitChange($event)"
      >
        <mat-option
          [value]="fractionTsForUnitEnum.Years"
          data-cy="fractionTsForUnitYears"
          >Years</mat-option
        >

        <mat-option
          [value]="fractionTsForUnitEnum.Quarters"
          data-cy="fractionTsForUnitQuarters"
          >Quarters</mat-option
        >

        <mat-option
          [value]="fractionTsForUnitEnum.Months"
          data-cy="fractionTsForUnitMonths"
          >Months</mat-option
        >

        <mat-option
          [value]="fractionTsForUnitEnum.Weeks"
          data-cy="fractionTsForUnitWeeks"
          >Weeks</mat-option
        >

        <mat-option
          [value]="fractionTsForUnitEnum.Days"
          data-cy="fractionTsForUnitDays"
          >Days</mat-option
        >

        <mat-option
          [value]="fractionTsForUnitEnum.Hours"
          data-cy="fractionTsForUnitHours"
          >Hours</mat-option
        >

        <mat-option
          [value]="fractionTsForUnitEnum.Minutes"
          data-cy="fractionTsForUnitMinutes"
          >Minutes</mat-option
        >
      </mat-select>
    </mat-form-field>
  </div>

  <!-- last -->
  <div
    *ngIf="fraction.type === fractionTypeEnum.TsIsInLast"
    fxLayout="row"
    fxLayoutGap="20px"
    fxLayoutAlign="start center"
  >
    <form [formGroup]="lastValueForm">
      <mat-form-field class="mp-fraction-last-value-width-50">
        <input
          matInput
          data-cy="fractionTsLastValue"
          type="number"
          formControlName="lastValue"
          (blur)="lastValueBlur(lastValueForm.controls['lastValue'])"
        />
        <mat-error>
          <m-validation-msg
            [errors]="lastValueForm.controls['lastValue'].errors"
          ></m-validation-msg>
        </mat-error>
      </mat-form-field>
    </form>

    <mat-form-field>
      <mat-select
        [(ngModel)]="fraction.ts_last_unit"
        data-cy="fractionTsLastUnit"
        (selectionChange)="lastUnitChange($event)"
      >
        <mat-option
          [value]="fractionTsLastUnitEnum.Years"
          data-cy="fractionTsLastUnitYears"
          >Years</mat-option
        >

        <mat-option
          [value]="fractionTsLastUnitEnum.Quarters"
          data-cy="fractionTsLastUnitQuarters"
          >Quarters</mat-option
        >

        <mat-option
          [value]="fractionTsLastUnitEnum.Months"
          data-cy="fractionTsLastUnitMonths"
          >Months</mat-option
        >

        <mat-option
          [value]="fractionTsLastUnitEnum.Weeks"
          data-cy="fractionTsLastUnitWeeks"
          >Weeks</mat-option
        >

        <mat-option
          [value]="fractionTsLastUnitEnum.Days"
          data-cy="fractionTsLastUnitDays"
          >Days</mat-option
        >

        <mat-option
          [value]="fractionTsLastUnitEnum.Hours"
          data-cy="fractionTsLastUnitHours"
          >Hours</mat-option
        >

        <mat-option
          [value]="fractionTsLastUnitEnum.Minutes"
          data-cy="fractionTsLastUnitMinutes"
          >Minutes</mat-option
        >
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-select
        class="mp-fraction-last-complete-option-width-230"
        data-cy="fractionTsLastCompleteOption"
        [(ngModel)]="fraction.ts_last_complete_option"
        (selectionChange)="lastCompleteChange($event)"
      >
        <mat-option
          [value]="fractionTsLastCompleteOptionEnum.Complete"
          data-cy="fractionTsLastCompleteOptionComplete"
          >complete</mat-option
        >

        <mat-option
          [value]="fractionTsLastCompleteOptionEnum.CompletePlusCurrent"
          data-cy="fractionTsLastCompleteOptionCompletePlusCurrent"
          >complete plus current</mat-option
        >

        <mat-option
          [value]="fractionTsLastCompleteOptionEnum.Incomplete"
          data-cy="fractionTsLastCompleteOptionIncomplete"
          >incomplete</mat-option
        >
      </mat-select>
    </mat-form-field>
  </div>

  <!-- TsIsNull -->
  <!-- TsIsNotNull -->
</div>
<div *ngIf="(weekStart$ | async)"></div>
